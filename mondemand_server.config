[
  { mondemand_server,
    [
      % LWES address and port to listen on, if UDP use address "0.0.0.0"
      { listener, {"0.0.0.0",20402} },

      % dispatch list, each event listed is sent to the list of modules
      { dispatch,
        [
          % catch all, all events are sent to this one unless it's empty
          { "*",                   [ mondemand_backend_all_journaller ] },
          { "MonDemand::StatsMsg", [ mondemand_backend_stats_rrd,
                                     mondemand_backend_stats_file
                                   ] },
          { "MonDemand::LogMsg",   [ mondemand_backend_log_file ] },
          { "MonDemand::TraceMsg", [ mondemand_backend_trace_couchdb ] }
        ]
      },

      % config for particular modules
      { mondemand_backend_all_journaller,
        [
          { root, ["/", "var","lib","mondemand","data","journals"] },
          { name, "all_events" },
          { interval, 60 }
        ]
      },
      { mondemand_backend_stats_rrd,
        [
          { context_delimiter, "-" },
          { root, ["/", "var","lib","mondemand","data","stats","rrd"] }
        ]
      },
      { mondemand_backend_stats_file,
        [
          { root, ["/", "var","lib","mondemand","data","stats","raw"] }
        ]
      },
      { mondemand_backend_log_file,
        [
          { root, ["/", "var","lib","mondemand","data","log"]}
        ]
      },
      { mondemand_backend_trace_couchdb,
        [
          { couch, {"localhost", 5984, "admin", "password"} }
        ]
      }
    ]
  },
  {
    erlrrd,
    [
      { cache,
        [
          { write_timeout, 3600 },
          { flush_timeout, 7200 },
          { root_dir, [ "/", "var", "run", "mondemand" ] }
        ]
      }
    ]
  }
].
